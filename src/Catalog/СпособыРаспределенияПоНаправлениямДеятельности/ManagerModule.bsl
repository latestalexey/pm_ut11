#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда


///////////////////////////////////////////////////////////////////////////////
// ПРОГРАММНЫЙ ИНТЕРФЕЙС

// Функция определяет способ распределения по умолчанию.
//
// Возвращает способ распределения, если найден один способ распределения.
// Возвращает пустую ссылку, если способ распределения не найден или найдено больше одного способа.
//
// Параметры:
//  ПравилоРаспределения - ПеречисленияСсылка.ПравилаРаспределенияПоНаправлениямДеятельности - Правило распределения
//
// Возвращаемое значение:
//	СправочникСсылка.СпособыРаспределенияПоНаправлениямДеятельности - Найденный способ распределения
//
Функция СпособРаспределенияПоУмолчанию(ПравилоРаспределения) Экспорт
	
	Запрос = Новый Запрос("
	|ВЫБРАТЬ
	|	МАКСИМУМ(СпособыРаспределения.Ссылка) КАК СпособРаспределения,
	|	КОЛИЧЕСТВО(СпособыРаспределения.Ссылка)
	|ИЗ
	|	Справочник.СпособыРаспределенияПоНаправлениямДеятельности КАК СпособыРаспределения
	|ГДЕ
	|	Не СпособыРаспределения.ПометкаУдаления
	|	И СпособыРаспределения.ПравилоРаспределения = &ПравилоРаспределения
	|
	|ИМЕЮЩИЕ
	|	КОЛИЧЕСТВО(СпособыРаспределения.Ссылка) = 1
	|");
	
	Запрос.УстановитьПараметр("ПравилоРаспределения", ПравилоРаспределения);
	
	Выборка = Запрос.Выполнить().Выбрать();
	Если Выборка.Следующий() Тогда
		СпособРаспределения = Выборка.СпособРаспределения;
	Иначе
		СпособРаспределения = Справочники.СпособыРаспределенияПоНаправлениямДеятельности.ПустаяСсылка();
	КонецЕсли;
	
	Возврат СпособРаспределения;

КонецФункции


#КонецЕсли