
////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	ПроцедураПриСозданииЧтенииНаСервере();
	
КонецПроцедуры

&НаСервере
Процедура ПриЧтенииНаСервере(ТекущийОбъект)
	
	ПроцедураПриСозданииЧтенииНаСервере();
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ЭЛЕМЕНТОВ ШАПКИ ФОРМЫ

&НаКлиенте
Процедура ОграничиватьРучныеСкидкиПриИзменении(Элемент)
	
	ОбновитьВидимостьЭлементовОграниченияРучныхСкидок(ЭтаФорма);
	
КонецПроцедуры

//////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ КОМАНД ФОРМЫ

&НаКлиенте
Процедура ИспользоватьИсключенияПоЦеновымГруппам(Команда)
	
	ИспользоватьИсключенияПоЦеновымГруппам = Истина;
	
	Элементы.ГруппаИспользоватьИсключенияПоЦеновымГруппам.Видимость = Не ИспользоватьИсключенияПоЦеновымГруппам;
	Элементы.ГруппаНеИспользоватьИсключенияПоЦеновымГруппам.Видимость = ИспользоватьИсключенияПоЦеновымГруппам;
	Элементы.ЦеновыеГруппы.Видимость = ИспользоватьИсключенияПоЦеновымГруппам;
	
КонецПроцедуры

&НаКлиенте
Процедура НеИспользоватьИсключенияПоЦеновымГруппам(Команда)
	
	Если Объект.ЦеновыеГруппы.Количество() > 0 Тогда
		РезультатВопроса = Вопрос("Таблица уточнений будет очищена, продолжить?", РежимДиалогаВопрос.ДаНет);
		Если РезультатВопроса = КодВозвратаДиалога.Нет Тогда
			Возврат;
		КонецЕсли;
	КонецЕсли;
	
	Объект.ЦеновыеГруппы.Очистить();
	
	ИспользоватьИсключенияПоЦеновымГруппам = Ложь;
	
	Элементы.ГруппаИспользоватьИсключенияПоЦеновымГруппам.Видимость = Не ИспользоватьИсключенияПоЦеновымГруппам;
	Элементы.ГруппаНеИспользоватьИсключенияПоЦеновымГруппам.Видимость = ИспользоватьИсключенияПоЦеновымГруппам;
	Элементы.ЦеновыеГруппы.Видимость = ИспользоватьИсключенияПоЦеновымГруппам;
	
КонецПроцедуры

//////////////////////////////////////////////////////////////////////////
// СЛУЖЕБНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

//////////////////////////////////////////////////////////////////////////
// Прочее

&НаКлиентеНаСервереБезКонтекста
Процедура ОбновитьВидимостьЭлементовОграниченияРучныхСкидок(Форма)
	
	ОграничиватьРучныеСкидки = Форма.Объект.ОграничиватьРучныеСкидки;
	
	Форма.Элементы.ПроцентРучнойСкидки.Доступность  = ОграничиватьРучныеСкидки;
	Форма.Элементы.ПроцентРучнойНаценки.Доступность = ОграничиватьРучныеСкидки;
	Форма.Элементы.ЦеновыеГруппы.Доступность = ОграничиватьРучныеСкидки;
	Форма.Элементы.ЦеновыеГруппы.Доступность = ОграничиватьРучныеСкидки;
	
	Форма.Элементы.ГруппаНеИспользоватьИсключенияПоЦеновымГруппам.Доступность = ОграничиватьРучныеСкидки;
	Форма.Элементы.ГруппаИспользоватьИсключенияПоЦеновымГруппам.Доступность = ОграничиватьРучныеСкидки;
	
КонецПроцедуры

&НаСервере
Процедура ПроцедураПриСозданииЧтенииНаСервере()
	
	ОбновитьВидимостьЭлементовОграниченияРучныхСкидок(ЭтаФорма);
	
	Если ПолучитьФункциональнуюОпцию("ИспользоватьЦеновыеГруппы") Тогда
		
		ИспользоватьИсключенияПоЦеновымГруппам = Объект.ЦеновыеГруппы.Количество() > 0;
		
		Элементы.ГруппаИспользоватьИсключенияПоЦеновымГруппам.Видимость = Не ИспользоватьИсключенияПоЦеновымГруппам;
		Элементы.ГруппаНеИспользоватьИсключенияПоЦеновымГруппам.Видимость = ИспользоватьИсключенияПоЦеновымГруппам;
		Элементы.ЦеновыеГруппы.Видимость = ИспользоватьИсключенияПоЦеновымГруппам;
		
	Иначе
		
		ИспользоватьИсключенияПоЦеновымГруппам = Ложь;
		
		Элементы.ГруппаНеИспользоватьИсключенияПоЦеновымГруппам.Видимость = Ложь;
		Элементы.ГруппаИспользоватьИсключенияПоЦеновымГруппам.Видимость = Ложь;
		Элементы.ЦеновыеГруппы.Видимость = Ложь;
		
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ПослеЗаписи(ПараметрыЗаписи)
	
	Оповестить("Запись_НастройкиПродажДляПользователей", ПараметрыЗаписи, Объект.Ссылка);
	
КонецПроцедуры



