////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	УправлениеЭлементами();
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ КОМАНД ФОРМЫ

////////////////////////////////////////////////////////////////////////////////
// Общие справочники

&НаКлиенте
Процедура ОткрытьСправочникСегментыПартнеров(Команда)
	
	ОткрытьФорму("Справочник.СегментыПартнеров.ФормаСписка", , ЭтаФорма);
	
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьСправочникСегментыНоменклатуры(Команда)
	
	ОткрытьФорму("Справочник.СегментыНоменклатуры.ФормаСписка", , ЭтаФорма);
	
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьПВХКаналыРекламныхВоздействий(Команда)
	
	ОткрытьФорму("ПланВидовХарактеристик.КаналыРекламныхВоздействий.ФормаСписка", , ЭтаФорма);
	
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьВидыЦен(Команда)
	
	ОткрытьФорму("Справочник.ВидыЦен.ФормаСписка", , ЭтаФорма);
	
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьВидыКартЛояльности(Команда)
	
	ОткрытьФорму("Справочник.ВидыКартЛояльности.ФормаСписка", , ЭтаФорма);
	
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьНастройкиПродаж(Команда)
	
	ОткрытьФорму("Справочник.НастройкиПродажДляПользователей.ФормаСписка", , ЭтаФорма);
	
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьВидыЦенПрайсЛист(Команда)
	
	ОткрытьЗначение(ВидЦеныПрайсЛист());
	
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьФорматыМагазинов(Команда)
	
	ОткрытьФорму("Справочник.ФорматыМагазинов.ФормаСписка", , ЭтаФорма);
	
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьТоварныеКатегории(Команда)
	
	ОткрытьФорму("Справочник.ТоварныеКатегории.ФормаСписка", , ЭтаФорма);
	
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьМарки(Команда)
	
	ОткрытьФорму("Справочник.Марки.ФормаСписка", , ЭтаФорма);
	
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьКвотыАссортимента(Команда)
	
	ОткрытьФорму("Документ.УстановкаКвотАссортимента.ФормаСписка", , ЭтаФорма);
	
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьПравилаПродаж(Команда)
	ОткрытьЗначение(ПолучитьСоглашение(ПредопределенноеЗначение("Перечисление.ХозяйственныеОперации.РеализацияКлиенту")));
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьПравилаПродажКомиссия(Команда)
	ОткрытьЗначение(ПолучитьСоглашение(ПредопределенноеЗначение("Перечисление.ХозяйственныеОперации.ПередачаНаКомиссию")));
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// СЛУЖЕБНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

&НаСервере
Процедура УправлениеЭлементами()

	ФиксироватьПервичныйИнтерес      = ПолучитьФункциональнуюОпцию("ФиксироватьПервичныйИнтерес");
	ИспользоватьСегментыНоменклатуры = ПолучитьФункциональнуюОпцию("ИспользоватьСегментыНоменклатуры");
	ИспользоватьСегментыПартнеров    = ПолучитьФункциональнуюОпцию("ИспользоватьСегментыПартнеров");
	ИспользоватьНесколькоВидовЦен    = ПолучитьФункциональнуюОпцию("ИспользоватьНесколькоВидовЦен");
	ИспользоватьАссортимент 		 = ПолучитьФункциональнуюОпцию("ИспользоватьАссортимент");
	ИспользоватьСоглашенияСКлиентами = ПолучитьФункциональнуюОпцию("ИспользоватьСоглашенияСКлиентами");
	ИспользоватьКомиссиюПриПродажах  = ПолучитьФункциональнуюОпцию("ИспользоватьКомиссиюПриПродажах");
	
	ИспользоватьОграниченияРучныхСкидокВПродажахПоПользователям = ПолучитьФункциональнуюОпцию(
			"ИспользоватьОграниченияРучныхСкидокВПродажахПоПользователям");
	ИспользоватьКартыЛояльности = ПолучитьФункциональнуюОпцию("ИспользоватьКартыЛояльности");
	
	ПравоДоступаСегментыНоменклатуры            = ПравоДоступа("Просмотр", Метаданные.Справочники.СегментыНоменклатуры);
	ПравоДоступаСегментыПартнеров               = ПравоДоступа("Просмотр", Метаданные.Справочники.СегментыПартнеров);
	ПравоДоступаВидыЦен                         = ПравоДоступа("Просмотр", Метаданные.Справочники.ВидыЦен);
	ПравоДоступаВидыКартЛояльности              = ПравоДоступа("Просмотр", Метаданные.Справочники.ВидыКартЛояльности);
	ПравоДоступаКаналыРекламныхВоздействий      = ПравоДоступа(
			"Просмотр",
			Метаданные.ПланыВидовХарактеристик.КаналыРекламныхВоздействий
			);
	ПравоДоступаНастройкиПродажДляПользователей = ПравоДоступа(
			"Просмотр",
			Метаданные.Справочники.НастройкиПродажДляПользователей
			);
	ПравоДоступаАссортимент						= ПравоДоступа("Просмотр", Метаданные.Справочники.ТоварныеКатегории);
	ПравоДоступаСоглашенияСКлиентами = ПравоДоступа(
			"Просмотр",
			Метаданные.Справочники.СоглашенияСКлиентами
			);
	
	Элементы.ГруппаНастроекСегментыНоменклатуры.Видимость = ИспользоватьСегментыНоменклатуры И ПравоДоступаСегментыНоменклатуры;
	Элементы.ГруппаНастроекСегментыПартнеров.Видимость = ИспользоватьСегментыПартнеров И ПравоДоступаСегментыПартнеров;
	Элементы.ГруппаСегментация.Видимость = Элементы.ГруппаНастроекСегментыПартнеров.Видимость Или ПравоДоступаСегментыПартнеров;
	Элементы.ГруппаПервичныйИнтерес.Видимость = ФиксироватьПервичныйИнтерес И ПравоДоступаКаналыРекламныхВоздействий;
	Элементы.ГруппаНастроекВидовЦен.Видимость            = ПравоДоступаВидыЦен;
	Элементы.ГруппаНастроекВидовКартЛояльности.Видимость = ПравоДоступаВидыКартЛояльности И ИспользоватьКартыЛояльности;
	Элементы.ГруппаНастройкиПродаж.Видимость             = ПравоДоступаНастройкиПродажДляПользователей
			И ИспользоватьОграниченияРучныхСкидокВПродажахПоПользователям;
	
	Элементы.ГруппаНастроекВидовЦен.Видимость   = ПравоДоступаВидыЦен И ИспользоватьНесколькоВидовЦен;
	Элементы.ГруппаНастроекОдинВидЦен.Видимость = ПравоДоступаВидыЦен И Не ИспользоватьНесколькоВидовЦен;
	Элементы.ГруппаАссортимент.Видимость = ИспользоватьАссортимент И ПравоДоступаАссортимент;
	Элементы.ГруппаНастроекПравилаПродаж.Видимость         = ПравоДоступаСоглашенияСКлиентами И НЕ ИспользоватьСоглашенияСКлиентами;
	Элементы.ГруппаНастроекПравилаПродажКомиссия.Видимость = ПравоДоступаСоглашенияСКлиентами И НЕ ИспользоватьСоглашенияСКлиентами И ИспользоватьКомиссиюПриПродажах;
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// Прочее

&НаСервереБезКонтекста
Функция ВидЦеныПрайсЛист()
	
	Возврат Ценообразование.ВидЦеныПрайсЛист();
	
КонецФункции

&НаСервереБезКонтекста
Функция ПолучитьСоглашение(ХозяйственнаяОперация)
	
	Возврат Справочники.СоглашенияСКлиентами.ТиповыеПравилаПродаж(ХозяйственнаяОперация);
	
КонецФункции

