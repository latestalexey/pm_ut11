
///////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ

&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	ПараметрыФормы = Новый Структура("Отбор, ФиксированныеНастройки, КлючНазначенияИспользования, КлючВарианта, СформироватьПриОткрытии");
	ПараметрыФормы.СформироватьПриОткрытии = Истина;
	
	ПараметрыФормы.Отбор = Новый Структура("Документ", ПараметрКоманды);
	ПараметрыФормы.КлючНазначенияИспользования = Строка(ПараметрКоманды);
	
	Если ТипЗнч(ПараметрКоманды) = Тип("ДокументСсылка.РеализацияТоваровУслуг") Тогда	
		ПараметрыФормы.КлючВарианта = "ОстаткиТоваровДляПродажи";
		
	ИначеЕсли ТипЗнч(ПараметрКоманды) = Тип("ДокументСсылка.ОтчетОРозничныхПродажах") Тогда
		ПараметрыФормы.КлючВарианта = "ОстаткиТоваровДляПродажи";
		
	ИначеЕсли ТипЗнч(ПараметрКоманды) = Тип("ДокументСсылка.ПередачаТоваровМеждуОрганизациями") Тогда
		Если ПередачаТоваровМеждуОрганизациямиПоТоварамКОформлению(ПараметрКоманды) Тогда
			ПараметрыФормы.КлючВарианта = "ОстаткиТоваровКПередаче";
		Иначе
			ПараметрыФормы.КлючВарианта = "ОстаткиТоваровДляПродажи";
		КонецЕсли;
		
	Иначе
		ПараметрыФормы.КлючВарианта = "ОстаткиТоваровДляДокумента";
		
	КонецЕсли;
	
	ОткрытьФорму("Отчет.ОстаткиТоваровОрганизаций.Форма",
		ПараметрыФормы,
		ПараметрыВыполненияКоманды.Источник,
		ПараметрыВыполненияКоманды.Уникальность,
		ПараметрыВыполненияКоманды.Окно
	);
	
КонецПроцедуры

///////////////////////////////////////////////////////////////////////////////
// СЛУЖЕБНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

///////////////////////////////////////////////////////////////////////////////
// Прочее

&НаСервере
Функция ПередачаТоваровМеждуОрганизациямиПоТоварамКОформлению(ДокументСсылка)
	
	ПоТоварамКОформлению = Документы.ПередачаТоваровМеждуОрганизациями.ПолучитьРеквизитыДокумента(ДокументСсылка).ПоТоварамКОформлению;
	
	Возврат ПоТоварамКОформлению;
	
КонецФункции
