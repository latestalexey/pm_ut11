
&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	Если УправлениеПечатьюКлиент.ПроверитьДокументыПроведены(ПараметрКоманды, ПараметрыВыполненияКоманды.Источник) Тогда
		
		ЗапрашиватьПодтверждение = ОбщегоНазначения.ХранилищеОбщихНастроекЗагрузить("ОбщиеНастройкиПользователя", "ЗапрашиватьПодтверждениеПриПечатиКомплектаДокументов");
		Если ЗапрашиватьПодтверждение <> Неопределено Тогда
			ЗапрашиватьПодтверждениеПриПечатиКомплектаДокументов = ЗапрашиватьПодтверждение;
		Иначе
			ЗапрашиватьПодтверждениеПриПечатиКомплектаДокументов = Истина;
		КонецЕсли; 
		
		Если ЗапрашиватьПодтверждениеПриПечатиКомплектаДокументов Тогда
			
			Кнопки = Новый СписокЗначений;
			Кнопки.Добавить("КодВозвратаДиалога.Да",	НСтр("ru = 'Распечатать'"));
			Кнопки.Добавить("КодВозвратаДиалога.Нет",	НСтр("ru = 'Не печатать'"));
			
			Результат = СтандартныеПодсистемыКлиент.ВопросПользователю(
				НСтр("ru = 'Распечатать комплект документов на принтере?'"), 
				Кнопки,
				,
				КодВозвратаДиалога.Да, 
				НСтр("ru = 'Печать комплекта документов'"), 
				КодВозвратаДиалога.Нет, 
				ЗапрашиватьПодтверждениеПриПечатиКомплектаДокументов);
				
			ОбщегоНазначения.ХранилищеОбщихНастроекСохранить("ОбщиеНастройкиПользователя", "ЗапрашиватьПодтверждениеПриПечатиКомплектаДокументов", Не ЗапрашиватьПодтверждениеПриПечатиКомплектаДокументов);
			
			Если Результат <> КодВозвратаДиалога.Да Тогда
				Возврат;
			КонецЕсли;
			
		КонецЕсли;
		
		ПоказатьОповещениеПользователя(
			НСтр("ru = 'Документы отправлены на печать'"),
			,
			,
			БиблиотекаКартинок.Информация32
		); 
		
		УправлениеПечатьюКлиент.ВыполнитьКомандуПечатиНаПринтер(
			"РегистрСведений.НастройкиПечатиОбъектов",
			"КомплектДокументов",
			ПараметрКоманды,
			Неопределено
		);
		
	КонецЕсли;
	
КонецПроцедуры
